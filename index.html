<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>GilArt | Chinelos Personalizados</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --azul:#0d47a1;
  --dourado:#ffca28;
  --verde:#25d366;
}
body{margin:0;font-family:Arial;background:#f4f6f8}
.hero{
  background:linear-gradient(135deg,#0d47a1,#102a43);
  color:#fff;padding:60px 20px;text-align:center;
  border-bottom:5px solid var(--dourado)
}
.container{max-width:1100px;margin:auto;padding:20px}
.card{
  background:#fff;padding:25px;border-radius:15px;
  box-shadow:0 6px 15px rgba(0,0,0,.1);margin-bottom:25px
}
label{font-weight:bold}
input,select{width:100%;padding:12px;margin-top:6px;border-radius:8px;border:1px solid #ccc}
.galeria{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;margin:25px 0}
.galeria img{width:100%;border-radius:12px}
.total{text-align:center;font-size:1.6rem;font-weight:bold;color:#2e7d32;margin-top:15px}
.btn{width:100%;padding:16px;font-size:1.1rem;border:none;border-radius:12px;margin-top:15px;cursor:pointer}
.whats{background:var(--verde);color:#fff}
.pdf{background:var(--dourado)}
.whatsapp-fixo{
  position:fixed;bottom:20px;right:20px;width:60px;height:60px;
  background:var(--verde);color:#fff;font-size:32px;
  border-radius:50%;display:flex;align-items:center;justify-content:center;
  text-decoration:none;z-index:999
}
</style>
</head>

<body>

<div class="hero">
  <h1>Chinelos Personalizados GilArt</h1>
  <p id="textoHero">Eleg√¢ncia e conforto para momentos inesquec√≠veis</p>
</div>

<div class="container">

<div class="card">
  <label>Evento</label>
  <select id="evento" onchange="trocarEvento()">
    <option>Casamento</option>
    <option>Anivers√°rio Infantil</option>
    <option>Formatura</option>
  </select>
</div>

<div class="galeria">
  <img src="chinelo-casamento.png">
  <img src="chinelo-luxo.jpg">
  <img src="kit-chinelo-sacola.png">
</div>

<div class="card">
  <label>Nome do Cliente</label>
  <input id="nome">

  <label>Quantidade</label>
  <input type="number" id="qtd" value="20">

  <label>Modelo</label>
  <select id="modelo">
    <option value="30">Simples ‚Äì R$30</option>
    <option value="40">Personalizado ‚Äì R$40</option>
    <option value="55">Luxo ‚Äì R$55</option>
  </select>

  <div class="total" id="total">Total: R$ 0,00</div>
</div>

<button class="btn whats" onclick="enviarWhats()">üì≤ Enviar no WhatsApp</button>
<button class="btn pdf" onclick="gerarPDF()">üñ®Ô∏è Gerar PDF</button>

</div>

<a class="whatsapp-fixo" href="https://wa.me/5579999145044" target="_blank">üí¨</a>

<script>
const SHEETS_URL="https://script.google.com/macros/s/AKfycbyyHhlYtHXv09cU-t7Das1R74UezjwfcjDrYK82hvwmGI1cTSfa17NnsPGlaN1DOFRV-A/exec";

const qtd=document.getElementById("qtd");
const modelo=document.getElementById("modelo");
const totalDiv=document.getElementById("total");

function calcular(){
  totalDiv.innerText="Total: R$ "+(qtd.value*modelo.value).toFixed(2).replace(".",",");
}
[qtd,modelo].forEach(e=>e.addEventListener("input",calcular));
calcular();

function trocarEvento(){
  const t={
    "Casamento":"Eleg√¢ncia e carinho para agradecer seus convidados.",
    "Anivers√°rio Infantil":"Cores e divers√£o para os pequenos.",
    "Formatura":"Celebre sua conquista com estilo."
  };
  textoHero.innerText=t[evento.value];
}

function salvarPedido(){
  fetch(SHEETS_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      nome:nome.value,
      evento:evento.value,
      quantidade:qtd.value,
      modelo:modelo.options[modelo.selectedIndex].text,
      valor:totalDiv.innerText,
      status:"Or√ßamento"
    })
  }).catch(()=>{});
}

function enviarWhats(){
  salvarPedido();
  const msg=`Ol√°! Quero um or√ßamento.

Evento: ${evento.value}
Nome: ${nome.value}
Quantidade: ${qtd.value}
${totalDiv.innerText}`;
  window.open("https://wa.me/5579999145044?text="+encodeURIComponent(msg));
}

function gerarPDF(){
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  let y=20;
  doc.setFontSize(18);
  doc.text("OR√áAMENTO GILART",105,y,{align:"center"});
  y+=15;
  doc.setFontSize(12);
  doc.text(`Cliente: ${nome.value}`,20,y);y+=8;
  doc.text(`Evento: ${evento.value}`,20,y);y+=8;
  doc.text(`Quantidade: ${qtd.value}`,20,y);y+=8;
  doc.text(`Modelo: ${modelo.options[modelo.selectedIndex].text}`,20,y);y+=10;
  doc.setFontSize(14);
  doc.text(totalDiv.innerText,20,y);
  doc.save("orcamento-gilart.pdf");
}
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Admin ‚Äì GilArt</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
table{width:100%;border-collapse:collapse;background:#fff}
th,td{padding:10px;border:1px solid #ccc;text-align:left}
th{background:#0d47a1;color:#fff}
button{padding:10px;margin-bottom:15px}
</style>
</head>
<body>

<h2>Painel de Pedidos ‚Äì GilArt</h2>
<button onclick="exportar()">üìä Exportar Excel</button>

<table id="tabela">
<thead>
<tr>
<th>Data</th>
<th>Nome</th>
<th>Evento</th>
<th>Qtd</th>
<th>Modelo</th>
<th>Valor</th>
<th>Status</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
const URL="https://script.google.com/macros/s/AKfycbyyHhlYtHXv09cU-t7Das1R74UezjwfcjDrYK82hvwmGI1cTSfa17NnsPGlaN1DOFRV-A/exec";

fetch(URL)
.then(r=>r.json())
.then(d=>{
  const tbody=document.querySelector("tbody");
  d.forEach(p=>{
    tbody.innerHTML+=`
      <tr>
        <td>${p.data}</td>
        <td>${p.nome}</td>
        <td>${p.evento}</td>
        <td>${p.quantidade}</td>
        <td>${p.modelo}</td>
        <td>${p.valor}</td>
        <td>${p.status||"Or√ßamento"}</td>
      </tr>`;
  });
});

function exportar(){
  const wb=XLSX.utils.table_to_book(document.getElementById("tabela"));
  XLSX.writeFile(wb,"pedidos-gilart.xlsx");
}
</script>

</body>
</html>
